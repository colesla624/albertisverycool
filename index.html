<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>3D Platformer Mobile</title>
<style>
    body { margin: 0; overflow: hidden; background: #000; }
    #controls {
        position: fixed;
        bottom: 20px;
        width: 100%;
        display: flex;
        justify-content: center;
        gap: 20px;
        z-index: 10;
        user-select: none;
    }
    .btn {
        width: 70px;
        height: 70px;
        background: rgba(255,255,255,0.5);
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 30px;
    }
</style>
</head>

<body>

<!-- Mobile Controls -->
<div id="controls">
    <div class="btn" id="left">‚üµ</div>
    <div class="btn" id="jump">‚¨Ü</div>
    <div class="btn" id="right">‚ü∂</div>
</div>

<!-- Three.js -->
<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>

<script>
/* ---------- SETUP ---------- */
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(70, innerWidth/innerHeight, 0.1, 1000);
camera.position.set(0, 5, 12);

const renderer = new THREE.WebGLRenderer({antialias: true});
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

/* ---------- LIGHT ---------- */
const light = new THREE.DirectionalLight(0xffffff, 1.3);
light.position.set(5, 10, 5);
scene.add(light);

/* ---------- PLAYER ---------- */
const playerGeo = new THREE.BoxGeometry(1,1,1);
const playerMat = new THREE.MeshStandardMaterial({color: "red"});
const player = new THREE.Mesh(playerGeo, playerMat);
player.position.y = 1;
scene.add(player);

let velY = 0;
let onGround = false;

/* ---------- GROUND ---------- */
const ground = new THREE.Mesh(
    new THREE.BoxGeometry(30,1,30),
    new THREE.MeshStandardMaterial({color: "green"})
);
ground.position.y = -0.5;
scene.add(ground);

/* ---------- PLATFORM (EASY) ---------- */
const platform = new THREE.Mesh(
    new THREE.BoxGeometry(5,0.5,5),
    new THREE.MeshStandardMaterial({color: "lightblue"})
);
platform.position.set(0, 2, -5);
scene.add(platform);

/* ---------- GOAL ---------- */
const goal = new THREE.Mesh(
    new THREE.BoxGeometry(1,2,1),
    new THREE.MeshStandardMaterial({color: "yellow"})
);
goal.position.set(0, 3, -10);
scene.add(goal);

/* ---------- INPUT ---------- */
let left = false, right = false, jump = false;

// Keyboard
addEventListener("keydown", e => {
    if (e.key === "ArrowLeft") left = true;
    if (e.key === "ArrowRight") right = true;
    if (e.key === "ArrowUp") jump = true;
});
addEventListener("keyup", e => {
    if (e.key === "ArrowLeft") left = false;
    if (e.key === "ArrowRight") right = false;
    if (e.key === "ArrowUp") jump = false;
});

// Mobile
function bind(id, variable) {
    const btn = document.getElementById(id);
    btn.addEventListener("touchstart", () => window[variable] = true);
    btn.addEventListener("touchend", () => window[variable] = false);
}
bind("left", "left");
bind("right", "right");
bind("jump", "jump");

/* ---------- GAME LOOP ---------- */
function animate() {
    requestAnimationFrame(animate);

    // horizontal movement
    if (left) player.position.x -= 0.1;
    if (right) player.position.x += 0.1;

    // jumping
    if (jump && onGround) {
        velY = 0.28;
        onGround = false;
    }

    // apply gravity
    velY -= 0.01;
    player.position.y += velY;

    // ground collision
    if (player.position.y <= 1) {
        player.position.y = 1;
        velY = 0;
        onGround = true;
    }

    // platform collision (simple AABB)
    if (player.position.x > platform.position.x - 2.5 &&
        player.position.x < platform.position.x + 2.5 &&
        player.position.z > platform.position.z - 2.5 &&
        player.position.z < platform.position.z + 2.5 &&
        player.position.y <= 2.5 && player.position.y > 1) {

        player.position.y = 2.5;
        velY = 0;
        onGround = true;
    }

    // Check for winning
    if (player.position.distanceTo(goal.position) < 1.5) {
        alert("üéâ YOU WIN!");
        player.position.set(0,1,0);
    }

    renderer.render(scene, camera);
}
animate();

// Resize support
addEventListener("resize", () => {
    camera.aspect = innerWidth / innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(innerWidth, innerHeight);
});
</script>

</body>
</html>
