<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mobile Platformer</title>
<style>
    body {
        margin: 0;
        overflow: hidden;
        background: #87CEEB;
        font-family: Arial, sans-serif;
        touch-action: none;
    }

    canvas {
        display: block;
        background: #87CEEB;
    }

    /* Mobile controls */
    #controls {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 20px;
        z-index: 10;
    }
    .btn {
        width: 70px;
        height: 70px;
        background: rgba(255,255,255,0.6);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 30px;
        user-select: none;
    }
</style>
</head>
<body>

<canvas id="game"></canvas>

<!-- Mobile Buttons -->
<div id="controls">
    <div class="btn" id="left">âŸµ</div>
    <div class="btn" id="jump">â¬†</div>
    <div class="btn" id="right">âŸ¶</div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

// Game objects
const player = {
    x: 50,
    y: 0,
    w: 40,
    h: 40,
    velX: 0,
    velY: 0,
    speed: 4,
    jumping: false
};

const gravity = 0.5;

// Platforms
const platforms = [
    {x: 0, y: canvas.height - 40, w: canvas.width, h: 40},
    {x: 120, y: canvas.height - 140, w: 150, h: 20},
    {x: 300, y: canvas.height - 260, w: 180, h: 20},
    {x: 550, y: canvas.height - 200, w: 160, h: 20},
];

// Goal flag
const goal = {
    x: 750,
    y: canvas.height - 300,
    w: 40,
    h: 80
};

// Input
let leftPressed = false;
let rightPressed = false;
let jumpPressed = false;

document.addEventListener("keydown", e => {
    if (e.key === "ArrowLeft") leftPressed = true;
    if (e.key === "ArrowRight") rightPressed = true;
    if (e.key === "ArrowUp") jumpPressed = true;
});
document.addEventListener("keyup", e => {
    if (e.key === "ArrowLeft") leftPressed = false;
    if (e.key === "ArrowRight") rightPressed = false;
    if (e.key === "ArrowUp") jumpPressed = false;
});

// Mobile buttons
function bindButton(id, variable) {
    const btn = document.getElementById(id);
    btn.addEventListener("touchstart", () => window[variable] = true);
    btn.addEventListener("touchend", () => window[variable] = false);
}
bindButton("left", "leftPressed");
bindButton("right", "rightPressed");
bindButton("jump", "jumpPressed");

function update() {
    // Movement
    if (leftPressed) player.velX = -player.speed;
    else if (rightPressed) player.velX = player.speed;
    else player.velX = 0;

    // Jump
    if (jumpPressed && !player.jumping) {
        player.velY = -10;
        player.jumping = true;
    }

    // Gravity
    player.velY += gravity;

    // Apply movement
    player.x += player.velX;
    player.y += player.velY;

    // Collision with platforms
    for (let p of platforms) {
        if (
            player.x < p.x + p.w &&
            player.x + player.w > p.x &&
            player.y + player.h > p.y &&
            player.y + player.h < p.y + p.h + player.velY
        ) {
            player.y = p.y - player.h;
            player.velY = 0;
            player.jumping = false;
        }
    }

    // Goal collision
    if (
        player.x < goal.x + goal.w &&
        player.x + player.w > goal.x &&
        player.y < goal.y + goal.h &&
        player.y + player.h > goal.y
    ) {
        alert("ðŸŽ‰ You win!");
        player.x = 50;
        player.y = 0;
    }

    // Boundaries
    if (player.x < 0) player.x = 0;
    if (player.x + player.w > canvas.width) player.x = canvas.width - player.w;

    draw();
    requestAnimationFrame(update);
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Draw player
    ctx.fillStyle = "red";
    ctx.fillRect(player.x, player.y, player.w, player.h);

    // Draw platforms
    ctx.fillStyle = "green";
    for (let p of platforms) {
        ctx.fillRect(p.x, p.y, p.w, p.h);
    }

    // Draw goal flag
    ctx.fillStyle = "yellow";
    ctx.fillRect(goal.x, goal.y, goal.w, goal.h);
}

update();
</script>

</body>
</html>
